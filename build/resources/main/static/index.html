<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quartz Manager UI</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #4e73df;
            --secondary-color: #858796;
            --success-color: #1cc88a;
            --info-color: #36b9cc;
            --warning-color: #f6c23e;
            --danger-color: #e74a3b;
            --light-color: #f8f9fc;
            --dark-color: #5a5c69;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f4f9;
        }
        
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(180deg, var(--primary-color) 10%, #224abe 100%);
            color: white;
        }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,.8);
            padding: 1rem;
            font-weight: 700;
        }
        
        .sidebar .nav-link:hover {
            color: rgba(255,255,255,1);
            background-color: rgba(255,255,255,.1);
        }
        
        .sidebar .nav-link.active {
            color: white;
            background-color: rgba(255,255,255,.2);
        }
        
        .card {
            border: none;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58,59,69,.15);
            transition: box-shadow 0.3s;
        }
        
        .card:hover {
            box-shadow: 0 0.25rem 2rem 0 rgba(58,59,69,.25);
        }
        
        .card-header {
            background-color: #f8f9fc;
            border-bottom: 1px solid #e3e6f0;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .badge-running { background-color: var(--success-color); }
        .badge-paused { background-color: var(--warning-color); }
        .badge-error { background-color: var(--danger-color); }
        .badge-complete { background-color: var(--info-color); }
        
        .status-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-dot.running { background-color: var(--success-color); }
        .status-dot.standby { background-color: var(--warning-color); }
        .status-dot.shutdown { background-color: var(--secondary-color); }
        
        .job-list-item {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .job-list-item:hover {
            background-color: var(--light-color);
        }
        
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }
        
        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div id="app"></div>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SockJS & STOMP -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    
    <!-- Main React App -->
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;
        
        // Toast Component
        const Toast = ({ message, type = 'info', onClose }) => {
            useEffect(() => {
                const timer = setTimeout(() => {
                    onClose();
                }, 5000);
                return () => clearTimeout(timer);
            }, [onClose]);
            
            const bgClass = {
                success: 'bg-success',
                error: 'bg-danger',
                warning: 'bg-warning',
                info: 'bg-info'
            }[type] || 'bg-info';
            
            return (
                <div className={`toast show`} role="alert">
                    <div className={`toast-header ${bgClass} text-white`}>
                        <strong className="me-auto">알림</strong>
                        <button type="button" className="btn-close btn-close-white" onClick={onClose}></button>
                    </div>
                    <div className="toast-body">
                        {message}
                    </div>
                </div>
            );
        };
        
        // Dashboard Component
        const Dashboard = ({ schedulerInfo, jobs, jobEvents }) => {
            const getSchedulerStatus = () => {
                if (!schedulerInfo) return { status: 'unknown', color: 'secondary' };
                if (schedulerInfo.isShutdown) return { status: 'shutdown', color: 'secondary' };
                if (schedulerInfo.isInStandbyMode) return { status: 'standby', color: 'warning' };
                if (schedulerInfo.isStarted) return { status: 'running', color: 'success' };
                return { status: 'unknown', color: 'secondary' };
            };
            
            const status = getSchedulerStatus();
            const runningJobs = jobs.filter(job => 
                job.triggers.some(t => t.state === 'NORMAL' || t.state === 'BLOCKED')
            ).length;
            const pausedJobs = jobs.filter(job => 
                job.triggers.some(t => t.state === 'PAUSED')
            ).length;
            const errorJobs = jobs.filter(job => 
                job.triggers.some(t => t.state === 'ERROR')
            ).length;
            
            return (
                <div className="row g-4">
                    <div className="col-xl-3 col-md-6">
                        <div className="card border-start border-primary border-4">
                            <div className="card-body">
                                <div className="row align-items-center">
                                    <div className="col">
                                        <div className="text-xs fw-bold text-primary text-uppercase mb-1">
                                            스케줄러 상태
                                        </div>
                                        <div className="h5 mb-0 fw-bold text-gray-800">
                                            <span className={`status-dot ${status.status}`}></span>
                                            {status.status.toUpperCase()}
                                        </div>
                                    </div>
                                    <div className="col-auto">
                                        <i className="bi bi-gear-fill fs-2 text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="col-xl-3 col-md-6">
                        <div className="card border-start border-success border-4">
                            <div className="card-body">
                                <div className="row align-items-center">
                                    <div className="col">
                                        <div className="text-xs fw-bold text-success text-uppercase mb-1">
                                            실행 중인 Jobs
                                        </div>
                                        <div className="h5 mb-0 fw-bold text-gray-800">{runningJobs}</div>
                                    </div>
                                    <div className="col-auto">
                                        <i className="bi bi-play-circle-fill fs-2 text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="col-xl-3 col-md-6">
                        <div className="card border-start border-warning border-4">
                            <div className="card-body">
                                <div className="row align-items-center">
                                    <div className="col">
                                        <div className="text-xs fw-bold text-warning text-uppercase mb-1">
                                            일시정지된 Jobs
                                        </div>
                                        <div className="h5 mb-0 fw-bold text-gray-800">{pausedJobs}</div>
                                    </div>
                                    <div className="col-auto">
                                        <i className="bi bi-pause-circle-fill fs-2 text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="col-xl-3 col-md-6">
                        <div className="card border-start border-danger border-4">
                            <div className="card-body">
                                <div className="row align-items-center">
                                    <div className="col">
                                        <div className="text-xs fw-bold text-danger text-uppercase mb-1">
                                            오류 Jobs
                                        </div>
                                        <div className="h5 mb-0 fw-bold text-gray-800">{errorJobs}</div>
                                    </div>
                                    <div className="col-auto">
                                        <i className="bi bi-exclamation-triangle-fill fs-2 text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* Recent Job Events */}
                    <div className="col-12">
                        <div className="card">
                            <div className="card-header">
                                <i className="bi bi-clock-history me-2"></i>
                                최근 Job 이벤트
                            </div>
                            <div className="card-body">
                                <div className="table-responsive">
                                    <table className="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>시간</th>
                                                <th>이벤트</th>
                                                <th>Job</th>
                                                <th>상태</th>
                                                <th>실행 시간</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {jobEvents.slice(0, 10).map((event, idx) => (
                                                <tr key={idx}>
                                                    <td>{new Date(event.timestamp).toLocaleString()}</td>
                                                    <td>
                                                        <span className={`badge ${
                                                            event.type === 'JOB_WAS_EXECUTED' ? 
                                                                (event.hasException ? 'bg-danger' : 'bg-success') :
                                                            event.type === 'JOB_TO_BE_EXECUTED' ? 'bg-info' :
                                                            'bg-secondary'
                                                        }`}>
                                                            {event.type}
                                                        </span>
                                                    </td>
                                                    <td>{event.jobName} ({event.jobGroup})</td>
                                                    <td>
                                                        {event.hasException ? 
                                                            <span className="text-danger">
                                                                <i className="bi bi-x-circle me-1"></i>실패
                                                            </span> : 
                                                            event.type === 'JOB_WAS_EXECUTED' ?
                                                            <span className="text-success">
                                                                <i className="bi bi-check-circle me-1"></i>성공
                                                            </span> : '-'
                                                        }
                                                    </td>
                                                    <td>{event.jobRunTime ? `${event.jobRunTime}ms` : '-'}</td>
                                                </tr>
                                            ))}
                                            {jobEvents.length === 0 && (
                                                <tr>
                                                    <td colSpan="5" className="text-center text-muted">
                                                        아직 이벤트가 없습니다
                                                    </td>
                                                </tr>
                                            )}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // Job List Component
        const JobList = ({ jobs, onJobSelect, onJobAction, selectedJob }) => {
            return (
                <div className="card">
                    <div className="card-header">
                        <i className="bi bi-list-task me-2"></i>
                        Job 목록
                    </div>
                    <div className="card-body p-0">
                        <div className="list-group list-group-flush">
                            {jobs.map(job => (
                                <div 
                                    key={`${job.group}-${job.name}`}
                                    className={`list-group-item job-list-item ${
                                        selectedJob?.name === job.name && selectedJob?.group === job.group ? 'active' : ''
                                    }`}
                                    onClick={() => onJobSelect(job)}
                                >
                                    <div className="d-flex justify-content-between align-items-start">
                                        <div>
                                            <h6 className="mb-1">{job.name}</h6>
                                            <p className="mb-1 small text-muted">그룹: {job.group}</p>
                                            <div>
                                                {job.triggers.map((trigger, idx) => (
                                                    <span key={idx} className={`badge me-1 ${
                                                        trigger.state === 'NORMAL' ? 'badge-running' :
                                                        trigger.state === 'PAUSED' ? 'badge-paused' :
                                                        trigger.state === 'ERROR' ? 'badge-error' :
                                                        'bg-secondary'
                                                    }`}>
                                                        {trigger.state}
                                                    </span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="btn-group btn-group-sm" onClick={e => e.stopPropagation()}>
                                            <button 
                                                className="btn btn-outline-success"
                                                onClick={() => onJobAction('trigger', job)}
                                                title="실행"
                                            >
                                                <i className="bi bi-play"></i>
                                            </button>
                                            <button 
                                                className="btn btn-outline-warning"
                                                onClick={() => onJobAction('pause', job)}
                                                title="일시정지"
                                            >
                                                <i className="bi bi-pause"></i>
                                            </button>
                                            <button 
                                                className="btn btn-outline-info"
                                                onClick={() => onJobAction('resume', job)}
                                                title="재개"
                                            >
                                                <i className="bi bi-arrow-clockwise"></i>
                                            </button>
                                            <button 
                                                className="btn btn-outline-danger"
                                                onClick={() => onJobAction('delete', job)}
                                                title="삭제"
                                            >
                                                <i className="bi bi-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                            {jobs.length === 0 && (
                                <div className="list-group-item text-center text-muted">
                                    등록된 Job이 없습니다
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };
        
        // Job Detail Component
        const JobDetail = ({ job }) => {
            if (!job) {
                return (
                    <div className="card">
                        <div className="card-body text-center text-muted">
                            Job을 선택하세요
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="card">
                    <div className="card-header">
                        <i className="bi bi-info-circle me-2"></i>
                        Job 상세 정보
                    </div>
                    <div className="card-body">
                        <h5>{job.name}</h5>
                        <table className="table table-sm">
                            <tbody>
                                <tr>
                                    <th width="30%">그룹</th>
                                    <td>{job.group}</td>
                                </tr>
                                <tr>
                                    <th>클래스</th>
                                    <td><code>{job.jobClass}</code></td>
                                </tr>
                                <tr>
                                    <th>설명</th>
                                    <td>{job.description || '-'}</td>
                                </tr>
                                <tr>
                                    <th>영구 저장</th>
                                    <td>{job.durability ? '예' : '아니오'}</td>
                                </tr>
                                <tr>
                                    <th>복구 요청</th>
                                    <td>{job.shouldRecover ? '예' : '아니오'}</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <h6 className="mt-4">Triggers</h6>
                        {job.triggers.map((trigger, idx) => (
                            <div key={idx} className="card mb-2">
                                <div className="card-body">
                                    <h6 className="card-title">{trigger.name}</h6>
                                    <table className="table table-sm mb-0">
                                        <tbody>
                                            <tr>
                                                <th width="30%">상태</th>
                                                <td>
                                                    <span className={`badge ${
                                                        trigger.state === 'NORMAL' ? 'badge-running' :
                                                        trigger.state === 'PAUSED' ? 'badge-paused' :
                                                        trigger.state === 'ERROR' ? 'badge-error' :
                                                        'bg-secondary'
                                                    }`}>
                                                        {trigger.state}
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>타입</th>
                                                <td>{trigger.type}</td>
                                            </tr>
                                            <tr>
                                                <th>다음 실행</th>
                                                <td>{trigger.nextFireTime ? new Date(trigger.nextFireTime).toLocaleString() : '-'}</td>
                                            </tr>
                                            <tr>
                                                <th>이전 실행</th>
                                                <td>{trigger.previousFireTime ? new Date(trigger.previousFireTime).toLocaleString() : '-'}</td>
                                            </tr>
                                            <tr>
                                                <th>우선순위</th>
                                                <td>{trigger.priority}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };
        
        // Create Job Modal
        const CreateJobModal = ({ show, onClose, onSubmit }) => {
            const [chainName, setChainName] = useState('demo');
            const [errorPolicy, setErrorPolicy] = useState('StopOnFirstErrorPolicy');
            
            const handleSubmit = (e) => {
                e.preventDefault();
                onSubmit({ chainName, errorPolicy });
                setChainName('demo');
                setErrorPolicy('StopOnFirstErrorPolicy');
            };
            
            if (!show) return null;
            
            return (
                <div className="modal show d-block" tabIndex="-1" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>
                    <div className="modal-dialog">
                        <div className="modal-content">
                            <div className="modal-header">
                                <h5 className="modal-title">새 Job 생성</h5>
                                <button type="button" className="btn-close" onClick={onClose}></button>
                            </div>
                            <form onSubmit={handleSubmit}>
                                <div className="modal-body">
                                    <div className="mb-3">
                                        <label className="form-label">Chain 이름</label>
                                        <input 
                                            type="text" 
                                            className="form-control" 
                                            value={chainName}
                                            onChange={(e) => setChainName(e.target.value)}
                                            required
                                        />
                                    </div>
                                    <div className="mb-3">
                                        <label className="form-label">에러 정책</label>
                                        <select 
                                            className="form-select" 
                                            value={errorPolicy}
                                            onChange={(e) => setErrorPolicy(e.target.value)}
                                        >
                                            <option value="StopOnFirstErrorPolicy">StopOnFirstErrorPolicy</option>
                                            <option value="SkipAndCollectErrorPolicy">SkipAndCollectErrorPolicy</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button type="button" className="btn btn-secondary" onClick={onClose}>
                                        취소
                                    </button>
                                    <button type="submit" className="btn btn-primary">
                                        생성
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };
        
        // Main App Component
        const App = () => {
            const [activeView, setActiveView] = useState('dashboard');
            const [jobs, setJobs] = useState([]);
            const [selectedJob, setSelectedJob] = useState(null);
            const [schedulerInfo, setSchedulerInfo] = useState(null);
            const [jobEvents, setJobEvents] = useState([]);
            const [toasts, setToasts] = useState([]);
            const [showCreateModal, setShowCreateModal] = useState(false);
            const [loading, setLoading] = useState(false);
            const stompClientRef = useRef(null);
            
            // Toast helper
            const showToast = useCallback((message, type = 'info') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
            }, []);
            
            const removeToast = useCallback((id) => {
                setToasts(prev => prev.filter(t => t.id !== id));
            }, []);
            
            // Fetch jobs
            const fetchJobs = useCallback(async () => {
                try {
                    const response = await fetch('/api/jobs');
                    const data = await response.json();
                    setJobs(data);
                } catch (error) {
                    showToast('Job 목록을 가져오는데 실패했습니다', 'error');
                }
            }, [showToast]);
            
            // Fetch scheduler info
            const fetchSchedulerInfo = useCallback(async () => {
                try {
                    const response = await fetch('/api/scheduler/info');
                    const data = await response.json();
                    setSchedulerInfo(data);
                } catch (error) {
                    showToast('스케줄러 정보를 가져오는데 실패했습니다', 'error');
                }
            }, [showToast]);
            
            // Handle job actions
            const handleJobAction = useCallback(async (action, job) => {
                setLoading(true);
                try {
                    let url, method = 'POST', body = null;
                    
                    switch (action) {
                        case 'trigger':
                            url = `/api/jobs/${job.group}/${job.name}/trigger`;
                            break;
                        case 'pause':
                            url = `/api/jobs/${job.group}/${job.name}/pause`;
                            break;
                        case 'resume':
                            url = `/api/jobs/${job.group}/${job.name}/resume`;
                            break;
                        case 'delete':
                            url = `/api/jobs/${job.group}/${job.name}`;
                            method = 'DELETE';
                            break;
                        default:
                            return;
                    }
                    
                    const response = await fetch(url, {
                        method,
                        headers: { 'Content-Type': 'application/json' },
                        body: body ? JSON.stringify(body) : null
                    });
                    
                    if (response.ok) {
                        showToast(`Job ${action} 성공`, 'success');
                        fetchJobs();
                    } else {
                        throw new Error('작업 실패');
                    }
                } catch (error) {
                    showToast(`Job ${action} 실패: ${error.message}`, 'error');
                } finally {
                    setLoading(false);
                }
            }, [fetchJobs, showToast]);
            
            // Handle scheduler actions
            const handleSchedulerAction = useCallback(async (action) => {
                setLoading(true);
                try {
                    const response = await fetch(`/api/scheduler/${action}`, { method: 'POST' });
                    if (response.ok) {
                        showToast(`스케줄러 ${action} 성공`, 'success');
                        fetchSchedulerInfo();
                    } else {
                        throw new Error('작업 실패');
                    }
                } catch (error) {
                    showToast(`스케줄러 ${action} 실패: ${error.message}`, 'error');
                } finally {
                    setLoading(false);
                }
            }, [fetchSchedulerInfo, showToast]);
            
            // Create new job
            const handleCreateJob = useCallback(async ({ chainName, errorPolicy }) => {
                setLoading(true);
                try {
                    const response = await fetch(`/api/jobs/trigger?chain=${chainName}&policy=${errorPolicy}`, {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        showToast('Job 생성 성공', 'success');
                        setShowCreateModal(false);
                        fetchJobs();
                    } else {
                        throw new Error('Job 생성 실패');
                    }
                } catch (error) {
                    showToast(`Job 생성 실패: ${error.message}`, 'error');
                } finally {
                    setLoading(false);
                }
            }, [fetchJobs, showToast]);
            
            // Setup WebSocket
            useEffect(() => {
                const socket = new SockJS('/ws');
                const stompClient = Stomp.over(socket);
                
                stompClient.connect({}, () => {
                    console.log('WebSocket 연결됨');
                    
                    stompClient.subscribe('/topic/job-events', (message) => {
                        const event = JSON.parse(message.body);
                        setJobEvents(prev => [event, ...prev].slice(0, 100));
                        
                        // Show toast for important events
                        if (event.type === 'JOB_WAS_EXECUTED') {
                            if (event.hasException) {
                                showToast(`Job 실행 실패: ${event.jobName}`, 'error');
                            } else {
                                showToast(`Job 실행 완료: ${event.jobName}`, 'success');
                            }
                        }
                        
                        // Refresh jobs list
                        fetchJobs();
                    });
                }, (error) => {
                    console.error('WebSocket 연결 실패:', error);
                    showToast('실시간 업데이트 연결 실패', 'warning');
                });
                
                stompClientRef.current = stompClient;
                
                return () => {
                    if (stompClient && stompClient.connected) {
                        stompClient.disconnect();
                    }
                };
            }, [fetchJobs, showToast]);
            
            // Initial data fetch
            useEffect(() => {
                fetchJobs();
                fetchSchedulerInfo();
            }, [fetchJobs, fetchSchedulerInfo]);
            
            return (
                <div className="d-flex">
                    {/* Sidebar */}
                    <div className="sidebar p-3" style={{ width: '250px' }}>
                        <h4 className="mb-4">
                            <i className="bi bi-gear-fill me-2"></i>
                            Quartz Manager
                        </h4>
                        <nav className="nav flex-column">
                            <a 
                                className={`nav-link ${activeView === 'dashboard' ? 'active' : ''}`}
                                href="#"
                                onClick={(e) => { e.preventDefault(); setActiveView('dashboard'); }}
                            >
                                <i className="bi bi-speedometer2 me-2"></i>
                                대시보드
                            </a>
                            <a 
                                className={`nav-link ${activeView === 'jobs' ? 'active' : ''}`}
                                href="#"
                                onClick={(e) => { e.preventDefault(); setActiveView('jobs'); }}
                            >
                                <i className="bi bi-list-task me-2"></i>
                                Jobs
                            </a>
                            <a 
                                className={`nav-link ${activeView === 'scheduler' ? 'active' : ''}`}
                                href="#"
                                onClick={(e) => { e.preventDefault(); setActiveView('scheduler'); }}
                            >
                                <i className="bi bi-gear me-2"></i>
                                스케줄러
                            </a>
                        </nav>
                    </div>
                    
                    {/* Main Content */}
                    <div className="flex-grow-1 p-4">
                        <div className="container-fluid">
                            {/* Header */}
                            <div className="d-flex justify-content-between align-items-center mb-4">
                                <h1 className="h3 mb-0 text-gray-800">
                                    {activeView === 'dashboard' && '대시보드'}
                                    {activeView === 'jobs' && 'Job 관리'}
                                    {activeView === 'scheduler' && '스케줄러 설정'}
                                </h1>
                                {activeView === 'jobs' && (
                                    <button 
                                        className="btn btn-primary"
                                        onClick={() => setShowCreateModal(true)}
                                        disabled={loading}
                                    >
                                        <i className="bi bi-plus-circle me-2"></i>
                                        새 Job 생성
                                    </button>
                                )}
                            </div>
                            
                            {/* Content */}
                            {activeView === 'dashboard' && (
                                <Dashboard 
                                    schedulerInfo={schedulerInfo}
                                    jobs={jobs}
                                    jobEvents={jobEvents}
                                />
                            )}
                            
                            {activeView === 'jobs' && (
                                <div className="row g-4">
                                    <div className="col-md-6">
                                        <JobList 
                                            jobs={jobs}
                                            onJobSelect={setSelectedJob}
                                            onJobAction={handleJobAction}
                                            selectedJob={selectedJob}
                                        />
                                    </div>
                                    <div className="col-md-6">
                                        <JobDetail job={selectedJob} />
                                    </div>
                                </div>
                            )}
                            
                            {activeView === 'scheduler' && (
                                <div className="row g-4">
                                    <div className="col-12">
                                        <div className="card">
                                            <div className="card-header">
                                                <i className="bi bi-info-circle me-2"></i>
                                                스케줄러 정보
                                            </div>
                                            <div className="card-body">
                                                {schedulerInfo && (
                                                    <div className="row">
                                                        <div className="col-md-6">
                                                            <table className="table table-sm">
                                                                <tbody>
                                                                    <tr>
                                                                        <th width="40%">이름</th>
                                                                        <td>{schedulerInfo.schedulerName}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>인스턴스 ID</th>
                                                                        <td>{schedulerInfo.schedulerInstanceId}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>상태</th>
                                                                        <td>
                                                                            {schedulerInfo.isStarted && <span className="badge badge-running">실행 중</span>}
                                                                            {schedulerInfo.isInStandbyMode && <span className="badge badge-paused">대기</span>}
                                                                            {schedulerInfo.isShutdown && <span className="badge bg-secondary">종료</span>}
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>버전</th>
                                                                        <td>{schedulerInfo.metaData?.version}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div className="col-md-6">
                                                            <table className="table table-sm">
                                                                <tbody>
                                                                    <tr>
                                                                        <th width="40%">JobStore</th>
                                                                        <td><code>{schedulerInfo.metaData?.jobStoreClass}</code></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>ThreadPool</th>
                                                                        <td>{schedulerInfo.metaData?.threadPoolSize} threads</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>실행된 Jobs</th>
                                                                        <td>{schedulerInfo.metaData?.numberOfJobsExecuted}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th>시작 시간</th>
                                                                        <td>{schedulerInfo.metaData?.runningSince ? 
                                                                            new Date(schedulerInfo.metaData.runningSince).toLocaleString() : '-'}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                <div className="mt-4">
                                                    <h6>스케줄러 제어</h6>
                                                    <div className="btn-group" role="group">
                                                        <button 
                                                            className="btn btn-success"
                                                            onClick={() => handleSchedulerAction('start')}
                                                            disabled={loading || schedulerInfo?.isStarted}
                                                        >
                                                            <i className="bi bi-play-fill me-1"></i>
                                                            시작
                                                        </button>
                                                        <button 
                                                            className="btn btn-warning"
                                                            onClick={() => handleSchedulerAction('standby')}
                                                            disabled={loading || !schedulerInfo?.isStarted || schedulerInfo?.isInStandbyMode}
                                                        >
                                                            <i className="bi bi-pause-fill me-1"></i>
                                                            대기
                                                        </button>
                                                        <button 
                                                            className="btn btn-danger"
                                                            onClick={() => {
                                                                if (confirm('스케줄러를 종료하시겠습니까?')) {
                                                                    handleSchedulerAction('shutdown');
                                                                }
                                                            }}
                                                            disabled={loading || schedulerInfo?.isShutdown}
                                                        >
                                                            <i className="bi bi-stop-fill me-1"></i>
                                                            종료
                                                        </button>
                                                        <button 
                                                            className="btn btn-outline-danger"
                                                            onClick={() => {
                                                                if (confirm('모든 Job을 삭제하시겠습니까?')) {
                                                                    handleSchedulerAction('clear');
                                                                }
                                                            }}
                                                            disabled={loading}
                                                        >
                                                            <i className="bi bi-trash-fill me-1"></i>
                                                            초기화
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {/* Toasts */}
                    <div className="toast-container">
                        {toasts.map(toast => (
                            <Toast 
                                key={toast.id}
                                message={toast.message}
                                type={toast.type}
                                onClose={() => removeToast(toast.id)}
                            />
                        ))}
                    </div>
                    
                    {/* Create Job Modal */}
                    <CreateJobModal 
                        show={showCreateModal}
                        onClose={() => setShowCreateModal(false)}
                        onSubmit={handleCreateJob}
                    />
                    
                    {/* Loading Overlay */}
                    {loading && (
                        <div style={{
                            position: 'fixed',
                            top: 0,
                            left: 0,
                            right: 0,
                            bottom: 0,
                            backgroundColor: 'rgba(0,0,0,0.5)',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            zIndex: 9999
                        }}>
                            <div className="spinner-border text-light" role="status">
                                <span className="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // Render the app
        ReactDOM.render(<App />, document.getElementById('app'));
    </script>
</body>
</html>
